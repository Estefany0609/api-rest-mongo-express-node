traerSimulador = select position_type, portfolio_user.ticker, qyt, entry_date, entry_price, close, (CASE WHEN position_type = $2 THEN cast ( 100 * (close - entry_price) / NULLIF (entry_price,0) as decimal (20,2)) WHEN position_type = $3 THEN cast ( -100 * (close - entry_price) / NULLIF (entry_price,0) as decimal (20,2)) END ) profit_loss, total_stock_grade, sector, industry, sub_industry, volume, preassure_daily, signal_cp, alert_cp, _5_days_presion, _10_days_presion, _20_days_presion, signal_mp, alert_mp, _50_days_presion, _100_days_presion, signal_lp, alert_lp, _200_days_presion, eps_date, quarter, surprise_percentage, ytd_var_percentage, var_price_high from web_financial.portfolio_user LEFT OUTER JOIN (   SELECT DISTINCT ON (ticker) * FROM web_financial.listado_historico_general  where date is not null ORDER BY ticker, date DESC) diario ON diario.ticker = web_financial.portfolio_user.ticker where uid = $1